doctype html
html(lang=$localeName)

  head
    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width, initial-scale=1, shrink-to-fit=no')
    meta(name='description', content=$i18n.meta.description)
    meta(name='author', content='nicolas.thomas@inkan.link')

    title #{$i18n.title}


    link(rel='canonical', href='https://sealf.ie/'+$localeName+'/')
    link(rel='alternate', hreflang='x-default', href='https://sealf.ie/')
    link(rel='alternate', hreflang='en', href='https://sealf.ie/en/')
    link(rel='alternate', hreflang='fr', href='https://sealf.ie/fr/')

    link(rel='icon', type='image/x-icon', href='/assets/favicon.svg')
    
    // Open Graph meta tags for social sharing
    meta(property='og:title', content=$i18n.title)
    meta(property='og:description', content=$i18n.meta.description)
    meta(property='og:image', content='https://sealf.ie/assets/img/sealfie-og-image.jpg')
    meta(property='og:url', content='https://sealf.ie/'+$localeName+'/')
    meta(property='og:type', content='website')
    meta(property='og:site_name', content='Sealfie')
    
    // Twitter Card meta tags
    meta(name='twitter:card', content='summary_large_image')
    meta(name='twitter:site', content='@sealfieapp')
    meta(name='twitter:creator', content='@inkanlink')
    meta(name='twitter:title', content=$i18n.title)
    meta(name='twitter:description', content=$i18n.meta.description)
    meta(name='twitter:image', content='https://sealf.ie/assets/img/sealfie-twitter-card.jpg')
    
    // Additional SEO meta tags
    meta(name='keywords', content='deepfake protection, executive fraud prevention, cybersecurity app, BEC protection, email fraud, identity verification')
    meta(name='robots', content='index, follow')
    meta(name='theme-color', content='#667eea')
    
    // Schema.org structured data
    script(type='application/ld+json').
      {
        "@context": "https://schema.org",
        "@type": "MobileApplication",
        "name": "Sealfie",
        "description": "#{$i18n.meta.description}",
        "operatingSystem": "Android, iOS",
        "applicationCategory": "SecurityApplication",
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.8",
          "ratingCount": "127"
        },
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "author": {
          "@type": "Organization",
          "name": "Inkan.link",
          "url": "https://inkan.link"
        }
      }

    // Preconnect to external domains for performance
    link(rel='preconnect', href='https://fonts.googleapis.com')
    link(rel='preconnect', href='https://fonts.gstatic.com', crossorigin)
    link(rel='preconnect', href='https://cdn.jsdelivr.net')
    
    // DNS prefetch and preconnect for YouTube
    link(rel='dns-prefetch', href='//www.youtube.com')
    link(rel='dns-prefetch', href='//img.youtube.com')
    link(rel='preconnect', href='https://www.youtube.com', crossorigin)
    link(rel='preconnect', href='https://img.youtube.com', crossorigin)
    
    // Preconnect to analytics domains for performance
    link(rel='dns-prefetch', href='//cdn.matomo.cloud')
    link(rel='dns-prefetch', href='//chimpstatic.com')
    
    // Preload critical resources
    link(rel='preload', as='image', href='/assets/img/optimized/BlockChainPhone.webp')
    link(rel='preload', as='image', href='https://img.youtube.com/vi/-zetGGK4UKo/maxresdefault.jpg')
    link(rel='preload', as='image', href='https://img.youtube.com/vi/-kDaGpo5LO0/maxresdefault.jpg')

    // Load Bootstrap icons asynchronously
    link(rel='preload', as='style', href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css', onload="this.onload=null;this.rel='stylesheet'")
    noscript
      link(href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css', rel='stylesheet')

    // Load Google fonts asynchronously
    link(rel='preload', as='style', href='https://fonts.googleapis.com/css2?family=Newsreader:ital,wght@0,600;1,600&display=swap', onload="this.onload=null;this.rel='stylesheet'")
    link(rel='preload', as='style', href='https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,300;0,500;0,600;0,700;1,300;1,500;1,600;1,700&display=swap', onload="this.onload=null;this.rel='stylesheet'")
    link(rel='preload', as='style', href='https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,400;1,400&display=swap', onload="this.onload=null;this.rel='stylesheet'")
    noscript
      link(href='https://fonts.googleapis.com/css2?family=Newsreader:ital,wght@0,600;1,600&display=swap', rel='stylesheet')
      link(href='https://fonts.googleapis.com/css2?family=Mulish:ital,wght@0,300;0,500;0,600;0,700;1,300;1,500;1,600;1,700&display=swap', rel='stylesheet')
      link(href='https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,400;1,400&display=swap', rel='stylesheet')

    // Critical CSS inline for above-the-fold content
    style.
      /* Critical CSS for hero section and navbar */
      .masthead { min-height: 100vh; display: flex; align-items: center; }
      .navbar-brand { font-weight: 600; }
      .display-1 { font-size: clamp(2.5rem, 8vw, 4.5rem); line-height: 1.1; }
      .text-gradient { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
      
    // Core theme CSS (includes Bootstrap) - loaded asynchronously
    link(rel='preload', as='style', href='/css/styles.css', onload="this.onload=null;this.rel='stylesheet'")
    noscript
      link(href='/css/styles.css', rel='stylesheet')


    include ../pug/includes/navbar.pug


  //- Video Trailer - Timer-based lazy loading
  aside.text-center.bg-gradient-primary-to-secondary
    .container.px-5
       .row.gx-5.justify-content-center
        .col-lg-8
            .h2.fs-1.text-white.mb-1 #{$i18n.trailer}
            .video-container
                if $localeName == "fr"
                    .youtube-timer-load(data-video-id="-zetGGK4UKo" data-load-delay="2000")
                        .youtube-preview
                            img(src="https://img.youtube.com/vi/-zetGGK4UKo/maxresdefault.jpg" alt="Video preview" loading="lazy" style="width: 100%; height: 100%; object-fit: cover;")
                            .video-hover-overlay
                                .play-indicator
                                    svg(width="68" height="48" viewBox="0 0 68 48")
                                        path(d="M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z" fill="#f00")
                                        path(d="M 45,24 27,14 27,34" fill="#fff")
                else
                    .youtube-timer-load(data-video-id="-kDaGpo5LO0" data-load-delay="2000")
                        .youtube-preview
                            img(src="https://img.youtube.com/vi/-kDaGpo5LO0/maxresdefault.jpg" alt="Video preview" loading="lazy" style="width: 100%; height: 100%; object-fit: cover;")
                            .video-hover-overlay
                                .play-indicator
                                    svg(width="68" height="48" viewBox="0 0 68 48")
                                        path(d="M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42-6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z" fill="#f00")
                                        path(d="M 45,24 27,14 27,34" fill="#fff")

  // Mashead header
  header.masthead
    .container.px-5
      .row.gx-5.align-items-center
        .col-lg-6
          // Mashead text and app badges
          .mb-5.mb-lg-0.text-center.text-lg-start
            h1.display-1.lh-1.mb-3 #{$i18n.head.title}
            p.lead.fw-normal.text-muted.mb-5 #{$i18n.head.subtitle} [1]
            p.lead.fw-normal.text-muted.mb-5 #{$i18n.head.subtitle2}
            .d-flex.flex-column.flex-lg-row.align-items-center
              a.me-lg-3.mb-4.mb-lg-0(href='https://play.google.com/store/apps/details?id=link.inkan.sealfie')
                img.app-badge(src='/assets/img/google-play-badge.svg', alt='...')
              a(href='https://apps.apple.com/app/id1635309517')
                img.app-badge(src='/assets/img/app-store-badge.svg', alt='...')
        .col-lg-6
          // Masthead device mockup feature
          .masthead-device-mockup
            include includes/gradient-circle
            include includes/shape-1
            include includes/shape-2
            .device-wrapper
              .device(data-device='iPhoneX', data-orientation='portrait', data-color='black')
                .screen.bg-black

                  // PUT CONTENTS HERE:
                  // * * This can be a video, image, or just about anything else.
                  // * * Set the max width of your media to 100% and the height to
                  // * * 100% like the demo example below.
                  .video-timer-container(data-video="/assets/img/"+$i18n.videos.demo1 data-load-delay="3000")
                    .video-poster-placeholder(style="max-width: 100%; height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 14px; text-align: center; position: relative;")
                      .demo-text Sealfie Demo
                      .video-hover-indicator(style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0; transition: opacity 0.3s ease;")
                        svg(width="40" height="40" viewBox="0 0 24 24" fill="none")
                          circle(cx="12" cy="12" r="10" stroke="white" stroke-width="2" fill="rgba(255,255,255,0.2)")
                          polygon(points="10,8 16,12 10,16" fill="white")

  // Quote/testimonial aside
  aside.text-center.bg-gradient-primary-to-secondary
    .container.px-5
      .row.gx-5.justify-content-center
        .col-l-8
          .h2.fs-1.text-white.mb-4 #{$i18n.centeredmsg}
        img(src='/assets/img/InkanLogo-32x32.svg', alt='...', style='height: 6rem;', href='https://inkan.link')

  // App features section
  section#features
    .container.px-5
      .row.gx-5.align-items-center
        .col-lg-8.order-lg-1.mb-5.mb-lg-0
          .container-fluid.px-5
            .row.gx-5
              .col-md-6.mb-5
                // Feature item list is at: https://icons.getbootstrap.com/
                .text-center
                  i.bi-send-check.icon-feature.text-gradient.d-block.mb-3
                  h3.font-alt #{$i18n.features.person.title}
                  p.text-muted.mb-0 #{$i18n.features.person.text}
              .col-md-6.mb-5
                // Feature item
                .text-center
                  i.bi-person-check.icon-feature.text-gradient.d-block.mb-3
                  h3.font-alt #{$i18n.features.send.title}
                  p.text-muted.mb-0 #{$i18n.features.send.text}
            .row
              .col-md-6.mb-5.mb-md-0
                // Feature item
                .text-center
                  i.bi-award.icon-feature.text-gradient.d-block.mb-3
                  h3.font-alt #{$i18n.features.shield.title}
                  p.text-muted.mb-0 #{$i18n.features.shield.text}
              .col-md-6
                // Feature item
                .text-center
                  i.bi-shield-check.icon-feature.text-gradient.d-block.mb-3
                  h3.font-alt #{$i18n.features.path.title}
                  p.text-muted.mb-0 #{$i18n.features.path.text}
        .col-lg-4.order-lg-0
          // Features section device mockup
          .features-device-mockup
            include includes/gradient-circle
            include includes/shape-1
            include includes/shape-2
            .device-wrapper
              .device(data-device='iPhoneX', data-orientation='portrait', data-color='black')
                .screen.bg-black
                  // PUT CONTENTS HERE:
                  // * * This can be a video, image, or just about anything else.
                  // * * Set the max width of your media to 100% and the height to
                  // * * 100% like the demo example below.
                  .video-timer-container(data-video="/assets/img/"+$i18n.videos.demo2 data-load-delay="4000")
                    .video-poster-placeholder(style="max-width: 100%; height: 100%; background: linear-gradient(135deg, #764ba2 0%, #667eea 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 14px; text-align: center; position: relative;")
                      .demo-text Protection Demo
                      .video-hover-indicator(style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0; transition: opacity 0.3s ease;")
                        svg(width="40" height="40" viewBox="0 0 24 24" fill="none")
                          circle(cx="12" cy="12" r="10" stroke="white" stroke-width="2" fill="rgba(255,255,255,0.2)")
                          polygon(points="10,8 16,12 10,16" fill="white")


  // Quote/testimonial aside
  aside.text-center.bg-gradient-primary-to-secondary
    .container.px-5
      .row.gx-5.justify-content-center
        .col-l-8
          if $localeName == "en"
            img(src='/assets/img/InkanLogo-32x32.svg', alt='...', style='height: 6rem;', href='https://inkan.link')
          else
            iframe(type='text/html' width='640' height='390'
            src='https://www.youtube.com/embed/22lzekNe87w?autoplay=1&mute=1&loop=1&playlist=22lzekNe87w&origin=https://sealf.ie'
            frameborder='0')
          .h2.fs-1.text-white.mb-4 #{$i18n.testimonial}


  // Call to action section
  section.cta
    .cta-content
      .container.px-5
        h2.text-white.display-1.lh-1.mb-4
          | #{$i18n.action.stop}
          br
          |#{$i18n.action.start}
        a.btn.btn-outline-light.button.py-3.px-4.rounded-pill(href="mailto:contact@sealf.ie") #{$i18n.action.linktext}


  // Tech explanation section
  section.bg-light
    .container.px-5
      .row.gx-5.align-items-center.justify-content-center.justify-content-lg-between
        .col-12.col-lg-5
          h2.display-4.lh-1.mb-4 #{$i18n.description.title}
          p.lead.fw-normal.text-muted.mb-5.mb-lg-0 #{$i18n.description.text}
          p.lead.fw-normal.text-muted.mb-5.mb-lg-0 #{$i18n.description.text2}
          p.lead.fw-normal.text-muted.mb-5.mb-lg-0 #{$i18n.description.text3}
        .col-sm-8.col-md-6
          .px-5.px-sm-0
            picture
              source(srcset='../assets/img/optimized/BlockChainPhone.webp', type='image/webp')
              source(srcset='../assets/img/optimized/BlockChainPhone.jpeg', type='image/jpeg')
              img.img-fluid.rounded-circle(src='../assets/img/BlockChainPhone.jpeg', alt='Blockchain phone security illustration showing secure mobile authentication technology', loading='lazy')


  // App badge section
  section#download.bg-gradient-primary-to-secondary
    .container.px-5
      h2.text-center.text-white.font-alt.mb-4 #{$i18n.appstore.download}
      .d-flex.flex-column.flex-lg-row.align-items-center.justify-content-center
        a.me-lg-3.mb-4.mb-lg-0(href='https://play.google.com/store/apps/details?id=link.inkan.sealfie')
          img.app-badge(src='/assets/img/google-play-badge.svg', alt='...')
        a(href='https://apps.apple.com/app/id1635309517')
          img.app-badge(src='/assets/img/app-store-badge.svg', alt='...')



    include ../pug/includes/footer.pug

  // Bootstrap core JS
  script(src='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js', integrity='sha512-7Pi/otdlbbCR+LnW+F7PwFcSDJOuUJB3OxtEHbg4vSMvzvJjde4Po1v4BR9Gdc9aXNUNFVUY+SK51wWT8WF0Gg==', crossorigin='anonymous')

  // Core theme JS
  script(src='/js/scripts.js')

  // Performance optimizations - Timer-based video loading with hover-to-play
  script.
    // YouTube timer-based loading
    function loadYouTubeVideo(element) {
      const videoId = element.dataset.videoId;
      const iframe = document.createElement('iframe');
      iframe.setAttribute('width', '100%');
      iframe.setAttribute('height', '90%');
      iframe.setAttribute('src', `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&loop=1&playlist=${videoId}&rel=0&modestbranding=1`);
      iframe.setAttribute('title', 'YouTube video player');
      iframe.setAttribute('frameborder', '0');
      iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
      iframe.setAttribute('allowfullscreen', '');
      iframe.style.cssText = 'width: 100%; height: 90%; border-radius: 8px;';
      element.innerHTML = '';
      element.appendChild(iframe);
    }

    // Device mockup video loading
    function loadDeviceVideo(container) {
      const videoSrc = container.dataset.video;
      const video = document.createElement('video');
      video.muted = true; // Set muted property directly
      video.setAttribute('muted', '');
      video.setAttribute('autoplay', '');
      video.setAttribute('loop', '');
      video.setAttribute('playsinline', '');
      video.style.cssText = 'max-width: 100%; height: 100%; object-fit: cover; border-radius: 4px;';
      video.addEventListener('loadeddata', function() {
        container.classList.remove('loading');
        // Ensure video is muted and starts playing
        video.muted = true; // Double-check muted state before playing
        video.play().catch(function(e) {
          console.log('Auto-play failed:', e);
        });
      });
      const source = document.createElement('source');
      source.src = videoSrc;
      source.type = 'video/webm';
      video.appendChild(source);
      container.innerHTML = '';
      // Final mute enforcement before adding to DOM
      video.muted = true;
      video.volume = 0; // Also set volume to 0 as extra precaution
      container.appendChild(video);
      return video;
    }

    // Timer-based loading manager
    function setupTimerLoading() {
      // YouTube timer loading
      document.querySelectorAll('.youtube-timer-load').forEach(function(element) {
        const loadDelay = parseInt(element.dataset.loadDelay) || 2000;
        let isLoaded = false;
        
        // Add initial loading indicator
        element.classList.add('timer-loading');
        
        // Set up timer-based loading
        setTimeout(function() {
          element.classList.remove('timer-loading');
          element.classList.add('loaded');
          
          // Auto-load video after timer completes
          element.classList.add('loading');
          setTimeout(function() {
            loadYouTubeVideo(element);
            isLoaded = true;
            element.classList.remove('loading');
          }, 500);
        }, loadDelay);

        // Set up hover-to-play functionality (backup if timer hasn't completed)
        element.addEventListener('mouseenter', function() {
          if (!isLoaded && !element.classList.contains('loaded') && !element.classList.contains('loading')) {
            element.classList.remove('timer-loading');
            element.classList.add('loading');
            setTimeout(function() {
              loadYouTubeVideo(element);
              isLoaded = true;
              element.classList.remove('loading');
            }, 300);
          }
        });
      });

      // Device video timer loading
      document.querySelectorAll('.video-timer-container').forEach(function(container) {
        const loadDelay = parseInt(container.dataset.loadDelay) || 3000;
        let video = null;
        let isLoaded = false;

        // Add initial loading indicator
        container.classList.add('timer-loading');

        // Set up timer-based loading
        setTimeout(function() {
          container.classList.remove('timer-loading');
          container.classList.add('loaded');
          
          // Auto-load video after timer completes
          container.classList.add('loading');
          video = loadDeviceVideo(container);
          isLoaded = true;
          container.classList.remove('loading');
        }, loadDelay);

        // Set up hover-to-play functionality (early trigger only)
        container.addEventListener('mouseenter', function() {
          if (!isLoaded && !container.classList.contains('loaded') && !container.classList.contains('loading')) {
            // Manual trigger if timer hasn't completed
            container.classList.remove('timer-loading');
            container.classList.add('loading');
            video = loadDeviceVideo(container);
            isLoaded = true;
            container.classList.remove('loading');
          }
          // No play/pause control - videos loop continuously once loaded
        });
      });
    }

    // Initialize timer-based loading when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
      setupTimerLoading();
    });

  // Core Web Vitals measurement
  script.
    // Web Vitals monitoring
    function vitals(name, value, id) {
      console.log('📊 Core Web Vital:', name, Math.round(value), 'ms', id);
      // Send to analytics if needed
      if (typeof gtag !== 'undefined') {
        gtag('event', name, {
          event_category: 'Web Vitals',
          event_label: id,
          value: Math.round(value),
          non_interaction: true,
        });
      }
    }
    
    // Measure LCP, FID, CLS
    if ('web-vital' in window || 'requestIdleCallback' in window) {
      import('https://unpkg.com/web-vitals@3/dist/web-vitals.js')
        .then(({onCLS, onFID, onLCP, onINP, onFCP, onTTFB}) => {
          onCLS(vitals);
          onFID(vitals);
          onLCP(vitals);
          onINP(vitals);
          onFCP(vitals);
          onTTFB(vitals);
        })
        .catch(err => console.log('Web Vitals not loaded:', err));
    }

  // Defer Mailchimp popup script
  script.
    setTimeout(function() {
      !function(c,h,i,m,p){m=c.createElement(h),p=c.getElementsByTagName(h)[0],m.async=1,m.src=i,p.parentNode.insertBefore(m,p)}(document,"script","https://chimpstatic.com/mcjs-connected/js/users/716e8fcfd71b495b7e4af1e92/38d3020ee67bdafdc3231e2272e1fa06.js");
    }, 5000);  // Load after 5 seconds (increased from 3)

