//
// Features Section with Japanese Inkan-Inspired Theme Support
//

section#features {
    background-color: var(--bg-secondary);
    position: relative;
    overflow: hidden;
    transition: background-color 0.2s ease;

    // Subtle Japanese pattern background (theme-aware)
    &:before {
        content: "";
        position: absolute;
        left: -5%;
        top: 20%;
        width: 30%;
        height: 60%;
        background-image: url("data:image/svg+xml,%3Csvg width='120' height='120' viewBox='0 0 120 120' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M9 0h2v20H9V0zm25.134.84l1.732 1-10 17.32-1.732-1 10-17.32zm-20 20l1.732 1-10 17.32-1.732-1 10-17.32zM58.16 4.134l1 1.732-17.32 10-1-1.732 17.32-10zm-40 40l1 1.732-17.32 10-1-1.732 17.32-10zM80 9v2H60V9h20zM20 69v2H0v-2h20zm79.32-55l-1 1.732-17.32-10L82 4l17.32 10zm-80 80l-1 1.732-17.32-10L2 84l17.32 10zm96.546-75.84l-1.732 1-10-17.32 1.732-1 10 17.32zm-100 100l-1.732 1-10-17.32 1.732-1 10 17.32zM38.16 24.134l1 1.732-17.32 10-1-1.732 17.32-10zM60 29v2H40v-2h20zm19.32 5l-1 1.732-17.32-10L62 24l17.32 10zm16.546 4.16l-1.732 1-10-17.32 1.732-1 10 17.32zM111 40h-2V20h2v20zm3.134.84l1.732 1-10 17.32-1.732-1 10-17.32zM40 49v2H20v-2h20zm19.32 5l-1 1.732-17.32-10L42 44l17.32 10zm16.546 4.16l-1.732 1-10-17.32 1.732-1 10 17.32zM91 60h-2V40h2v20zm3.134.84l1.732 1-10 17.32-1.732-1 10-17.32zm24.026 3.294l1 1.732-17.32 10-1-1.732 17.32-10zM39.32 74l-1 1.732-17.32-10L22 64l17.32 10zm16.546 4.16l-1.732 1-10-17.32 1.732-1 10 17.32zM71 80h-2V60h2v20zm3.134.84l1.732 1-10 17.32-1.732-1 10-17.32zm24.026 3.294l1 1.732-17.32 10-1-1.732 17.32-10zM120 89v2h-20v-2h20zm-84.134 9.16l-1.732 1-10-17.32 1.732-1 10 17.32zM51 100h-2V80h2v20zm3.134.84l1.732 1-10 17.32-1.732-1 10-17.32zm24.026 3.294l1 1.732-17.32 10-1-1.732 17.32-10zM100 109v2H80v-2h20zm19.32 5l-1 1.732-17.32-10 1-1.732 17.32 10zM31 120h-2v-20h2v20z' fill='%23FF3500' fill-opacity='0.02' fill-rule='evenodd'/%3E%3C/svg%3E");
        background-size: 120px 120px;
        z-index: 0;
        opacity: 0.5;
        transition: opacity 0.2s ease;
    }

    // Dark theme pattern adjustment
    [data-theme="dark"] &:before {
        opacity: 0.2;
    }

    h3 {
        font-family: $heading-font-japanese;
        letter-spacing: 0.02em;
        position: relative;
        display: inline-block;
        color: var(--text-primary);
        transition: color 0.2s ease;
    }
}

// Styling for the features icons - updated for theme system
section#features {
    .icon-feature {
        font-size: 4rem;
        background: linear-gradient(45deg, var(--shu-primary), var(--sango-accent));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        color: transparent;
        position: relative;
        transition: all 0.3s ease;

        // Add subtle circular background with theme support
        &:before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background-color: var(--hover-overlay);
            border-radius: 50%;
            z-index: -1;
            transition: all 0.3s ease;
        }

        // Hover effect
        &:hover:before {
            background-color: var(--shu-primary);
            transform: translate(-50%, -50%) scale(1.1);
        }
    }

    // Japanese hanko stamp-like accent lines
    .text-center {
        .icon-feature + h3 {
            &:after {
                content: "";
                display: block;
                width: 40px;
                height: 2px;
                background: linear-gradient(90deg, var(--shu-primary), var(--sango-accent));
                margin: 0.5rem auto 1rem;
                opacity: 0.7;
                transition: all 0.3s ease;
            }

            &:hover:after {
                width: 60px;
                opacity: 1;
            }
        }
    }
}

// Default styling for other pages with theme support
.icon-feature {
    font-size: 4rem;
    color: var(--shu-primary);
    transition: color 0.2s ease;
}

// Unified device mockup styling - single source of truth for all mockups
.device-mockup {
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    z-index: 1; // Establish stacking context

    // SVG background circle with subtle theme gradient  
    .circle {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        width: 60%;
        height: 60%;
        display: block;
        z-index: 0; // Behind device but within mockup context
        pointer-events: none; // Prevent interaction blocking

        .gradient-start-color {
            stop-color: var(--shu-primary); // Traditional Vermillion (Shu-iro)
        }

        .gradient-end-color {
            stop-color: var(--enji-secondary); // Crimson (Enji-iro)
        }
    }

    // Japanese-inspired decorative shapes with theme colors
    .shape-1 {
        position: absolute;
        height: 1.2rem;
        width: 1.2rem;
        transform: rotate(15deg);
        fill: var(--sango-accent);
        top: 5%;
        right: -5%;
        transition: fill 0.2s ease;
        z-index: 1;
    }

    .shape-2 {
        position: absolute;
        height: 0.8rem;
        width: 0.8rem;
        fill: var(--shu-primary);
        bottom: 5%;
        left: -5%;
        transition: fill 0.2s ease;
        z-index: 1;
    }

    // Device wrapper with consistent sizing and theme-aware shadow
    .device-wrapper {
        position: relative;
        max-width: 15rem;
        box-shadow: 0 10px 20px var(--shadow-color);
        transition: box-shadow 0.2s ease;
        z-index: 1; // Above circle but within mockup context

        &:hover {
            box-shadow: 0 15px 30px var(--shadow-color);
        }
    }
}

// All mockups now use centered positioning relative to phone

// Features section specific - smaller circle
.how-it-works-section .device-mockup .circle {
    width: 40%;
    height: 40%;
}

@include media-breakpoint-up(sm) {
    .how-it-works-section .device-mockup .circle {
        width: 45%;
        height: 45%;
    }
}

@include media-breakpoint-up(md) {
    .how-it-works-section .device-mockup .circle {
        width: 50%;
        height: 50%;
        transform: translate(-40%, -50%);
    }
}

@include media-breakpoint-up(lg) {
    .how-it-works-section .device-mockup .circle {
        width: 55%;
        height: 55%;
        transform: translate(-35%, -50%);
    }
}

// Responsive adjustments for device mockups
@include media-breakpoint-up(sm) {
    .device-mockup {
        .circle {
            width: 70%;
            height: 70%;
        }
        
        .device-wrapper {
            max-width: 16rem;
        }
    }
}

@include media-breakpoint-up(md) {
    .device-mockup {
        .circle {
            width: 80%;
            height: 80%;
            transform: translate(-40%, -50%); // Offset to the left
        }

        .device-wrapper {
            max-width: 17rem;
        }
    }
}

@include media-breakpoint-up(lg) {
    .device-mockup {
        .circle {
            width: 90%;
            height: 90%;
            transform: translate(-35%, -50%); // Slightly less offset
        }
        
        .device-wrapper {
            max-width: 18rem;
        }
    }
}
