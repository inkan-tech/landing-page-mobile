name: "Test Local Workflow"
# This workflow is ONLY for local testing with act - NOT for GitHub Actions
# It will never run on GitHub due to the impossible branch condition

on:
  push:
    branches: [ "act-local-test-only-never-on-github" ]
  # No workflow_dispatch to prevent manual GitHub runs

jobs:
  test-build:
    name: Test Build
    runs-on: ubuntu-latest
    
    steps:
    - name: Safety Check - Only run with act
      run: |
        if [ "$ACT" != "true" ]; then
          echo "❌ ERROR: This workflow should ONLY be run with act, not on GitHub Actions!"
          echo "This is a safety measure to prevent accidental GitHub runs."
          exit 1
        fi
        echo "✅ Confirmed running with act - proceeding with local test"
        
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Install system dependencies
      run: |
        if command -v sudo >/dev/null 2>&1; then
          sudo apt-get update
          sudo apt-get install -y nasm
        else
          apt-get update
          apt-get install -y nasm
        fi

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'

    - name: Install dependencies
      run: |
        npm install --no-optional
        npm install -g grunt-cli

    - name: Run build
      run: npm run build

    - name: List build output
      run: |
        echo "Build completed successfully"
        ls -la docs/
        
    - name: Test complete
      run: echo "✅ All tests passed!"